<div layout="row" class="mainArea">
    <div class="contactedUsers" ng-if="isBroker">
        <div class="contactedUsersTitle">Contacted Users</div>
        <div>
            <input name="search" ng-model="vm.searchUsername" type="search" ng-change="vm.changeUsers()" placeholder="Search" class="searchBar">
        </div>
        <div class="appointment ng-scope" ng-class='{active: $index==vm.selectedIndex}' ng-repeat="appointment in vm.userAppointmentsFiltered" ng-click="vm.selectUser($index)">
            <img src="/assets/images/alvaro.png" style="height: 40px; width:40px;">         
            <div class="detail">
                <div style="font-size: 14px;" class="ng-binding">{{appointment.fname}} {{appointment.lname}}</div>
                <!-- <div style="margin-top: 3px;opacity: 0.4;">3 Days Ago</div> -->
                <a class="pending-btn ng-binding" style="margin-top: 4px;">{{appointment.applicationStatus}}</a>
            </div>      
        </div>
    </div>
    <div flex layout="column">
    <md-stepper id="stepper-demo" md-linear="!isBroker">
        <div ng-if="isBroker">
        <md-step md-label="Account Summary" class="accSummary">
            <md-step-body>
            <div class="appointment ng-scope" layout="column">
            <div class="detail" layout="row" ng-if="vm.userAppointment" style="max-width: 90px;">
                <div style="font-size: 14px;" class="ng-binding">{{vm.userAppointment.fname}} {{vm.userAppointment.lname}}</div>
                <!-- <div style="margin-top: 3px;opacity: 0.4;">3 Days Ago</div> -->
                <a class="pending-btn ng-binding" style="margin-top: 10px;">{{vm.userAppointment.applicationStatus}}</a>
            </div>      
            <div layout="row" style="margin: 20px; ">
            <div flex="50" style="margin-right: 30px; ">
                <span class="title">Download Documents</span>
                <div class="documentTile">
                    <div style="float:left; padding:10px;">
                        <div class="header">Income Tax</div>
                        <div class="description">File Size: 1 mb</div>
                    </div>
                    <div style="float: right; border-left: solid 1px #e7ecf1;">
                        <img src="/assets/images/download.png"/>
                    </div>
                </div>
                <div class="documentTile">
                    <div style="float:left; padding:10px;">
                        <div class="header">Income Tax</div>
                        <div class="description">File Size: 1 mb</div>
                    </div>
                    <div style="float: right; border-left: solid 1px #e7ecf1;">
                        <img src="/assets/images/download.png"/>
                    </div>
                </div>
                <div class="documentTile">
                    <div style="float:left; padding:10px;">
                        <div class="header">Income Tax</div>
                        <div class="description">File Size: 1 mb</div>
                    </div>
                    <div style="float: right; border-left: solid 1px #e7ecf1;">
                        <img src="/assets/images/download.png"/>
                    </div>
                </div>
                <div style="margin-top:10px;">
                    <md-button class="md-raised md-success" ng-click="">Select All</md-button>
                    <md-button class="md-raised md-blue" ng-click="">Download All</md-button>
                </div>
            </div>
            <div flex="50">
                <span class="title">Appointment Slots</span>
                <div class="appointmentTile">
                    <div style="float:left; padding:10px;">
                        <div class="header">27th Oct 16, 07:20am</div>
                        <a class="pending-btn ng-binding">PENDING</a>
                    </div>
                    <div style="float: right; border-left: solid 1px #e7ecf1;">
                        <div class="actnItem">CONFIRM</div>
                    </div>
                </div>
                <div class="appointmentTile">
                    <div style="float:left; padding:10px;">
                        <div class="header">29th Oct 16, 07:20am</div>
                        <a class="pending-btn ng-binding">PENDING</a>
                    </div>
                    <div style="float: right; border-left: solid 1px #e7ecf1;">
                        <div class="actnItem">CONFIRM</div>
                    </div>
                </div>
                <div class="appointmentTile">
                    <div style="float:left; padding:10px;">
                        <div class="header">28th Oct 16, 07:20am</div>
                        <a class="pending-btn ng-binding">PENDING</a>
                    </div>
                    <div style="float: right; border-left: solid 1px #e7ecf1;">
                        <div class="actnItem">DONE</div>
                    </div>
                </div>
            </div>
            </div>
            </div>
            </md-step-body>
        </md-step>
        </div>
        <div ng-if="!isBroker">
            <md-step md-label="Select Broker">
                <md-step-body layout="row" layout-wrap>
                    <h3 class="partnersHeader">Premium Partners</h3>
                    <div ng-repeat="partner in ::vm.partners | filter:{brokerageCategory:'PREMIUM'}">
                        <div class="partnerLogo" ng-click="vm.toggleSelected(partner)" ng-class="{'selected': partner.selected }">
                            <img class="premiereIcon" src="/assets/images/premiere.png"/>
                            <center><img ng-src="{{partner.img}}"/></center>
                        </div>
                    </div>

                    <h3 class="partnersHeader">All Partners</h3>
                    <div ng-repeat="partner in ::vm.partners | filter:{brokerageCategory:'REGULAR'}">
                        <div class="partnerLogo" ng-click="vm.toggleSelected(partner)" ng-class="{'selected': partner.selected }">
                            <center><img ng-src="{{partner.img}}"/></center>
                        </div>
                    </div>

                </md-step-body>
            </md-step>
        </div>
            <div ng-if="!isBroker || isBroker">
                <md-step md-label="Personal Details">
                    <md-step-body>
                        <form name="personalDetailsForm" class="detailsForm">
                            <div layout="row">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>First name</label>
                                        <input required ng-model="user.firstName" name="firstName" minlength="6" maxlength="100">

                                        <div ng-messages="personalDetailsForm.firstName.$error" role="alert">
                                            <div ng-message-exp="['required', 'minlength', 'maxlength']">
                                                Please enter a name between 6 and 100 characters.
                                            </div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-right:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Last name</label>
                                        <input required ng-model="user.lastName" name="lastName" minlength="6" maxlength="100">
                                        <div ng-messages="personalDetailsForm.lastName.$error" role="alert">
                                            <div ng-message-exp="['required', 'minlength', 'maxlength']">
                                                Please enter the last name between 6 and 100 characters.
                                            </div>
                                        </div>
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row" style="margin-top:0px;">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex="30" style="float:left;">
                                        <label>Country Code</label>
                                        <input required ng-model="user.countryCode" minlength="6" maxlength="100">
                                    </md-input-container>
                                    <md-input-container class="md-block" flex="100" flex-offset="10" style="float:left;">
                                        <label>Hand Phone</label>
                                        <input required ng-model="user.phoneNum" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-right:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Email ID</label>
                                        <input required type="email" name="email" ng-model="user.email" minlength="10" maxlength="100" ng-pattern="/^.+@.+\..+$/" />

                                        <div ng-messages="personalDetailsForm.email.$error" role="alert">
                                            <div ng-message-exp="['required', 'minlength', 'maxlength', 'pattern']">
                                                Please enter a valid email Id.
                                            </div>
                                        </div>
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row" style="margin-top:0px;">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex="30" style="float:left;">
                                        <label>Country Code</label>
                                        <input required ng-model="user.countryCode" minlength="6" maxlength="100">
                                    </md-input-container>
                                    <md-input-container class="md-block" flex="100" flex-offset="10" style="float:left;">
                                        <label>Residence Phone</label>
                                        <input required ng-model="vm.questionsmap.residential_phone.answerText" minlength="6" maxlength="100">
                                    </md-input-container>

                                </div>
                                <div flex="50" class="col" style="margin-right:30px;">
                                    <md-input-container style="margin-left: -16px;margin-top: 0px;">
                                        <label>Date of Birth</label>
                                        <md-datepicker ng-model="vm.questionsmap.user_dob.answerText"></md-datepicker>
                                    </md-input-container>
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Nationality</label>
                                        <md-select ng-model="vm.questionsmap.nationality.answerText">
                                            <md-option><em>Singapore</em></md-option>
                                            <md-option ng-repeat="country in vm.countries" ng-value="country.name">
                                                {{country.name}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block">
                                        <label>Residential Address</label>
                                        <textarea ng-model='vm.questionsmap.residential_address.answerText' rows="2"></textarea>
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-right:30px;">
                                    <md-input-container class="md-block">
                                        <label>Mailing Address</label>
                                        <textarea ng-model='vm.questionsmap.mailing_address.answerText' rows="2"></textarea>
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block">
                                        <label>Passport Number</label>
                                        <input required ng-model="vm.questionsmap.passport_nric.answerText" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-right:30px;">
                                    <md-input-container class="md-block">
                                        <label>Employment Status</label>
                                        <md-select ng-model="vm.questionsmap.employment_status.answerId">
                                            <md-option ng-repeat="empstatus in vm.empStatuses" ng-value="empstatus.name">
                                                {{empstatus.name}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>
                                </div>
                            </div>
                        </form>

                    </md-step-body>
                </md-step>
            </div>
            <div ng-if="!isBroker || isBroker">
                <md-step md-label="KYC">
                    <md-step-body>
                        <form name="kycDetailsForm" class="detailsForm">
                            <div layout="row">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Tax Residence</label>
                                        <input required ng-model="vm.kycquestions['Tax Residence'].answerText" name="taxResidence" minlength="6" maxlength="100">

                                        <div ng-messages="kycDetailsForm.taxResidence.$error" role="alert">
                                            <div ng-message-exp="['required', 'minlength', 'maxlength']">
                                                Please enter a valid tax residence.
                                            </div>
                                        </div>
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-right:30px;">
                                    <md-input-container class="md-block" flex="30" style="float:left;">
                                        <label>Currency</label>
                                        <md-select ng-model="currency">
                                            <md-option ng-repeat="currency in vm.currencies" ng-value="currency.name">
                                                {{currency.name}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>                                
                                    <md-input-container class="md-block" flex="100" flex-offset="10" style="float:left;">
                                        <label>Annual Income</label>
                                        <input required ng-model="vm.kycquestions['Annual Income'].answerText" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row" style="margin-top:0px;">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Source of Wealth</label>
                                        <input required ng-model="vm.kycquestions['Source of Wealth'].answerText" name="sourceWealth" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Source of Fund</label>
                                        <input required ng-model="vm.kycquestions['Source of Funds'].answerText" name="sourceFund" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row" style="margin-top:0px;">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Estimated Liquid Assets</label>
                                        <input required ng-model="vm.kycquestions['Estimated Liquid Assets'].answerText" name="estimatedLiquidAssets" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Investment Objectives</label>
                                        <input required ng-model="vm.kycquestions['Investment Objectives'].answerText" name="investigationObjectives" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row" style="margin-top:0px;">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Likely frequency of Trades</label>
                                        <input required ng-model="vm.kycquestions['Likely frequency of Trades'].answerText" name="likelyFrequency" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Bank Reference</label>
                                        <input required ng-model="vm.kycquestions['Bank Reference'].answerText" name="bankRef" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row" style="margin-top:0px;">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Bank account number</label>
                                        <input required ng-model="vm.kycquestions['Bank Account Number'].answerText" name="bankAcc" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Language Proficiency</label>
                                        <input required ng-model="vm.kycquestions['Language Proficiency'].answerText" name="languagePro" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row" style="margin-top:0px;">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Academic Qualification</label>
                                        <input required ng-model="vm.kycquestions['Academic Qualification'].answerText" name="academicQualification" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Mother's Maiden Name</label>
                                        <input required ng-model="vm.kycquestions['Mother\'s Maiden Name'].answerText" name="motherMaidenName" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                            </div>

                            <div layout="row" style="margin-top:0px;">
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Name of Spouse</label>
                                        <input ng-model="vm.kycquestions['Name of Spouse'].answerText" name="spouseName" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                                <div flex="50" class="col" style="margin-left:30px;">
                                    <md-input-container class="md-block" flex-gt-sm>
                                        <label>Spouse’s Passport / NRIC Number</label>
                                        <input ng-model="vm.kycquestions['Spouse passport / NRIC number'].answerText" name="spousePassport" minlength="6" maxlength="100">
                                    </md-input-container>
                                </div>
                            </div>
                        </form>
                    </md-step-body>
                </md-step>
            </div>
            <div ng-if="!isBroker || isBroker">
                <md-step md-label="Documents">
                    <md-step-body>
                        <div class="flex-wrapper" style="height: calc(100vh - 90px); margin-bottom: -90px; margin-top: 20px;">
                            <div ng-repeat="document in ::vm.documents">
                                <document-pane style="float: left;" document="document"></document-pane>
                            </div>  
                        </div>
                    </md-step-body>
                </md-step>
            </div>
            <div ng-if="!isBroker">
                <md-step md-label="Selection of Timeslot">
                    <md-step-body layout="column" flex>
                        <div style="min-height: 800px; height: 800px;">
                            <md-event-calendar md-events="vm.events" md-event-click="vm.eventClicked($selectedEvent)" md-label="title" md-show-create-link="true" md-create-event-click="vm.eventCreate($date)" md-create-disabled="dis" class="md-primary">
                                <md-event-calendar-header class="md-center">
                                    <md-event-calendar-prev></md-event-calendar-prev>
                                    <md-event-calendar-title></md-event-calendar-title>
                                    <md-event-calendar-next></md-event-calendar-next>
                                    <!-- <md-event-calendar-today></md-event-calendar-today> -->
                                </md-event-calendar-header>
                            </md-event-calendar>
                        </div>
                    </md-step-body>
                </md-step>
            </div>
            <div ng-if="isBroker">
                <md-step md-label="Validation Reports">
                    <md-step-body layout="column" flex>
                        <div style="min-height: 800px; height: 800px;">
                            <div class="validationReport" ng-repeat="report in vm.validationReports">
                                <div style="float:left;">
                                    <div class="title">{{report.title}}
                                    </div>
                                    <div class="description">{{report.description}}
                                    </div>
                                </div>
                                <div style="float:right;">
                                    <img ng-click="toggleReport($index)" src="/assets/images/tickedgrey.png" class="ticked grey"/>
                                    <img ng-click="toggleReport($index)" class="unticked grey" src="/assets/images/untickedgrey.png"/>
                                </div>
                            </div>
                        </md-step-body>
                    </md-step>
                </div>
            </div>
        </md-stepper>

        <footer>
            <div layout="row" class="footerBtns" layout-align="start center" ng-if="!isBroker">
                <md-button class="md-raised md-back" ng-click="vm.backStep()">Back</md-button>
                <md-button class="md-raised md-success" ng-click="vm.nextStep()">Next</md-button>
                <!-- <md-button class="md-raised md-edit-form" ng-click="vm.editForm()">Edit Form</md-button> -->
            </div>
            <div layout="row" class="footerBtns" layout-align="start center" ng-if="isBroker">
                <md-button class="md-raised md-success" ng-click="vm.nextStep()">Accept</md-button>
            </div>

        </footer>

    </div>